
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Notes on RSA Cryptography - Mango Ice Cream</title>
  <meta name="author" content="Kevin Pan">

  
  <meta name="description" content="In RSA cryptography, there are two keys, a public key and a private key. The sender of a message uses the public key to encrypt the message and the &hellip;">
  
  <meta name="keywords" content="">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://kevinpan.me/blog/2014/12/06/notes-on-rsa">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Quicksand:300,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/custom.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Mango Ice Cream" type="application/atom+xml">
  <script src="/js/jquery.js"></script>
  <script src="/js/bootstrap-collapse.js"></script>
  <script src="/js/modernizr-2.0.js"></script>
  <script src="/js/octopress.js" type="text/javascript"></script>
  <script src="/js/application.js"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57905192-1', 'auto');
  ga('send', 'pageview');

</script>
<body   >
  <div class="navbar navbar-inverse navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
          <span class="fui-menu-24"></span>
        </a>
        <div class="nav-collapse collapse navbar-responsive-collapse" style="height:0;">
          <ul class="nav">
    
        <li ><a href="/">Home</a></li>
    
        <li ><a href="/blog/archives">Archives</a></li>
    
        <li ><a href="http://www.kevinpan.ca/about">About Me</a></li>
    
</ul>

<ul class="nav pull-right">
    
    
    
    
    
    
    

    
</ul>

        </div>
      </div>
    </div>
  </div>
  <div class="container" id="main">
      <div class="row-fluid">
        <div id="content">
          <div>
<article class="hentry" role="article">
  

  <header>
  <div class="jumbotron">
    Notes on RSA Cryptography
	<h5>




<i class="icon-calendar-empty"></i> <time class='entry-date' datetime='2014-12-06T16:10:31-08:00'><span class='date'><span class='date-month'>Dec</span> <span class='date-day'>6</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>4:10 pm</span></time></h5>
  </div>
</header>
  <div class="row-fluid">
    <div class="span12">
      <p>I first learnt about RSA cryptography during an introductory number theory course in my second study term in university. Like many things you learn in class, the details tend to quickly be forgotten once the exam’s over. RSA was no exception. However, I’ve always been strangely annoyed for not fully understanding how this cryptosystem works and so I intend for this post to act as a “reference sheet” for RSA.</p>

<p>In RSA cryptography, there are two keys: a public key and a private key. The sender of a message uses the public key to encrypt the message and the idea is that you can only decrypt the message if you have the private key associated with that public key.</p>

<h2 id="generating-keys">Generating keys</h2>

<ol>
  <li>Select two <strong>large</strong> distinct primes $p$ and $q$. Let $n = pq$</li>
  <li>Select $e \in \mathbb{Z}$ such that $GCD(e, \phi(n)) = 1$ and $1 \lt e \lt \phi(n)$, where $GCD$ is the greatest common denominator function</li>
  <li>Solve congruence $ed \equiv 1 (\textrm{mod}\ \phi(n))$ for $d$ where $d \in \mathbb{Z}, 1 &lt; d &lt; \phi(n)$</li>
</ol>

<p>The public key will be the tuple $(e, n)$ and the private key will be the tuple $(d, n)$. Note, $\phi(n)$ here refers to <a href="http://en.wikipedia.org/wiki/Euler%27s_totient_function">Euler’s totient function</a>, which is the number of positive integers less than or equal to n that are coprime with n. It also has the property that if two integers, $m$ and $n$ are coprime, then $\phi(mn) = \phi(m)\phi(n)$. Using this property and the fact that $p$ and $q$ are coprimes (since they are both primes), we note that $\phi(n) = \phi(pq) = \phi(p)\phi(q) = (p - 1)(q - 1)$.</p>

<h2 id="encrypting-and-decrypting-messages">Encrypting and decrypting messages</h2>

<p>Let $M$ be the message we want to encrypt. $M$ is an integer such that $0 \leq M \lt n$. The encrypted message will be $C$ where $C \equiv M^{e} (\textrm{mod}\ n), 0 \leq C \lt n $.</p>

<p>To decrypt the message, the receiver needs to compute integer $R$ where $R \equiv C^{d} (\textrm{mod}\ n), 0 \leq R \lt n$. It is actually the case that $R \equiv M (\textrm{mod}\ n)$ and since $0 \leq R \lt n$, $R = M$.</p>

<p>Overall, we need to prove that $(M^{e})^{d} \equiv M (\textrm{mod}\ n), \forall M \in \mathbb{Z}$.</p>

<h2 id="proof">Proof</h2>

<p>(This proof is really just my version of <a href="http://crypto.stackexchange.com/questions/2884/rsa-proof-of-correctness">this</a>)</p>

<p>We can break the proof into two cases, $GCD(M, n) = 1$ and $GCD(M, n) \neq 1$.</p>

<hr />

<p><strong>Case 1 ($GCD(M, n) = 1$):</strong></p>

<p>We start off by using Euler’s totient theorem which states that:</p>

<blockquote>
  <p>If $GCD(A, B) = 1$ then $A^{\phi(B)} \equiv 1 (\textrm{mod}\ B)$. In our case, since $GCD(M, n) = 1$, then $M^{\phi(n)} \equiv 1 (\textrm{mod}\ n)$.</p>
</blockquote>

<p>Since $ed \equiv 1 (\textrm{mod}\ \phi(n))$, then let $ed = 1 + k\phi(n)$ where $k \in \mathbb{Z}$. From this, we get that:</p>

<script type="math/tex; mode=display">(M^{e})^{d} = M^{ed} = M^{1 + k\phi(n)} = M(M^{k\phi(n)})</script>

<p>Using the above fact:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
M^{\phi(n)} & \equiv 1 (\textrm{mod}\ n) \\
M^{k\phi(n)} & \equiv 1^{k} (\textrm{mod}\ n) \\
M^{k\phi(n)} & \equiv 1 (\textrm{mod}\ n) \\
M(M^{k\phi(n)}) & \equiv M (\textrm{mod}\ n) \\
M^{ed} & \equiv M (\textrm{mod}\ n)
\end{align} %]]></script>

<hr />

<p><strong>Case 2 ($GCD(M, n) \neq 1$):</strong></p>

<p>We will use the Chinese remainder theorem to prove this.</p>

<blockquote>
  <p>A more specific version of the theorem states that:</p>
</blockquote>

<blockquote>
  <script type="math/tex; mode=display">% <![CDATA[
\begin{align}
x & \equiv y (\textrm{mod}\ A_1) \\
& ... \\
x & \equiv y (\textrm{mod}\ A_k) \\
\\
\text{if and only if...} \\
\\
x & \equiv y (\textrm{mod}\ A)
\end{align} %]]></script>
</blockquote>

<blockquote>
  <p>where $A_1, …, A_k$ are <strong>pairwise</strong> coprime and $A = A_1…A_k$.</p>
</blockquote>

<p>By the Chinese remainder theorem, we only need to prove the two congruences below to prove $(M^{e})^{d} \equiv M (\textrm{mod}\ n)$:</p>

<script type="math/tex; mode=display">\begin{align}
(M^{e})^{d} \equiv M (\textrm{mod}\ p)\tag{1} \\
(M^{e})^{d} \equiv M (\textrm{mod}\ q)\tag{2}
\end{align}</script>

<p>Since $GCD(M, n) \neq 1$, it must be true that either $GCD(M, n) = p$ or $GCD(M, n) = q$.</p>

<p>Without loss of generality, let’s assume that $GCD(M, n) = p$. Since $M$ is a multiple of $p$, let $M = kp, k \in \mathbb{Z}, k \gt 0$.</p>

<p>To prove (1):</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
M & \equiv kp (\textrm{mod}\ p) \\
M & \equiv 0 (\textrm{mod}\ p) \\
\\
\text{Using the above fact...} \\
\\
(M^{e})^{d} & \equiv M (\textrm{mod}\ p) \\
((kp)^{e})^{d} & \equiv M (\textrm{mod}\ p) \\
k^{ed}p^{ed} & \equiv 0 (\textrm{mod}\ p) \\
0 & \equiv 0 (\textrm{mod}\ p)
\end{align} %]]></script>

<p>For (2), we note that since $M = kp$, if $q$ divides $M$, then $q$ must divide either $k$ or $p$. $q$ cannot divide $p$ since they are both primes and $q$ cannot divide $k$. If $q$ does divide $k$, then it implies $M \geq n$ which $M$ cannot be. We reach the conclusion that $GCD(M, q) = 1$. By Euler’s totient theorem, $M^{\phi(q)} = M^{q - 1} \equiv 1 (\textrm{mod}\ q)$.</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align}
(M^{e})^{d} & = M^{ed} \\
& = M^{ed - 1}M \\
& = M^{k\phi(n)}M\tag{from before} \\
& = (M^{q - 1})^{k(p - 1)}M \\
& \equiv 1^{k(p - 1)}M (\textrm{mod}\ q) \\
& \equiv M (\textrm{mod}\ q)\tag*{$\square$}
\end{align} %]]></script>

<h2 id="why-is-rsa-secure">Why is RSA secure?</h2>

<p>The answer to this question lies in the fact that it is nearly impossible (by our current computing capabilities) to determine the private key from its corresponding public key, especially if the primes chosen are sufficiently large.</p>

<p>If the public key was $(e, n)$, then remember that to determine the private key you need to solve the congruence $ed \equiv 1 (\textrm{mod}\ \phi(n)), 1 \lt d \lt \phi(n)\ \text{and}\ \phi(n) = (p - 1)(q - 1)$. The best way to do so, without actually knowing what $\phi(n)$ is, is to prime factorize $n$ into its only two prime factors. This, as it turns out, is a very very hard thing to do. There <a href="http://en.wikipedia.org/wiki/Integer_factorization">doesn’t exist an algorithm</a> (with the exception of quantum algorithms) that can solve the problem in polynomial time.</p>

<blockquote>
  <p>I made a movie about cosmic cookware. It was universally panned.</p>
</blockquote>

    </div>
  </div>



  <footer>
    <hr>
    
    <div class="row-fluid">
      
      <div class="span6">
        <p class="meta">
        
        


        </p>
      </div>
      
      <div class="span6 social-sharing">
        <div class="sharing">
  <div class="addthis_toolbox addthis_default_style ">
  
  
  <a class="addthis_button_tweet"></a>
  
  
  <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>

      </div>
      
      
    </div>
    
    <div class="row-fluid">
      <div class="span12">
        <p class="meta">
          
            <a class="basic-alignment left" href="/blog/2014/12/01/garlic-brussel-sprouts-with-bacon-and-parmesan/" title="Previous Post: Garlic Brussel Sprouts with Bacon and Parmesan">&laquo; Garlic Brussel Sprouts with Bacon and Parmesan</a>
          
          
            <a class="basic-alignment right" href="/blog/2014/12/15/basic-rubberband-simulator/" title="Next Post: Basic Rubberband Simulation">Basic Rubberband Simulation &raquo;</a>
          
        </p>
      </div>
    </div>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>



        </div>
      </div>
      <div class="row-fluid">
        <footer class="footer-page" role="contentinfo">
          <p>
  Copyright &copy; 2015 - Kevin Pan -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span> - Theme by <a href="http://alexgaribay.com">Alex Garibay</a>
</p>


        </footer>
      </div>
  </div>
  

<script type="text/javascript">
      var disqus_shortname = 'mangoicecream';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://kevinpan.me/blog/2014/12/06/notes-on-rsa/';
        var disqus_url = 'http://kevinpan.me/blog/2014/12/06/notes-on-rsa/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
