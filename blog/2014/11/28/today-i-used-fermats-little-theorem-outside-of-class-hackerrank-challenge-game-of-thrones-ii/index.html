
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Today I used Fermat&#8217;s little theorem outside of class - Hackerrank Challenge: Game of Thrones II - Mango Ice Cream</title>
  <meta name="author" content="Kevin Pan">

  
  <meta name="description" content="This post provides a solution to the Hackerrank challenge, Game of Thrones II. The solution heavily relies on modular arithmetic. Learn how to &hellip;">
  
  <meta name="keywords" content="">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://kevinpan.me/blog/2014/11/28/today-i-used-fermats-little-theorem-outside-of-class-hackerrank-challenge-game-of-thrones-ii">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Quicksand:300,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/custom.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Mango Ice Cream" type="application/atom+xml">
  <script src="/js/jquery.js"></script>
  <script src="/js/bootstrap-collapse.js"></script>
  <script src="/js/modernizr-2.0.js"></script>
  <script src="/js/octopress.js" type="text/javascript"></script>
  <script src="/js/application.js"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57905192-1', 'auto');
  ga('send', 'pageview');

</script>
<body   >
  <div class="navbar navbar-inverse navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
          <span class="fui-menu-24"></span>
        </a>
        <div class="nav-collapse collapse navbar-responsive-collapse" style="height:0;">
          <ul class="nav">
    
        <li ><a href="/">Home</a></li>
    
        <li ><a href="/blog/archives">Archives</a></li>
    
        <li ><a href="http://www.kevinpan.ca/about">About Me</a></li>
    
</ul>

<ul class="nav pull-right">
    
    
    
    
    
    
    

    
</ul>

        </div>
      </div>
    </div>
  </div>
  <div class="container" id="main">
      <div class="row-fluid">
        <div id="content">
          <div>
<article class="hentry" role="article">
  

  <header>
  <div class="jumbotron">
    Today I Used Fermat&#8217;s Little Theorem Outside of Class - Hackerrank Challenge: Game of Thrones II
	<h5>




<i class="icon-calendar-empty"></i> <time class='entry-date' datetime='2014-11-28T02:05:51-08:00'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>28</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>2:05 am</span></time></h5>
  </div>
</header>
  <div class="row-fluid">
    <div class="span12">
      <p>This challenge asks you to find the number of possible palindrome anagrams in a word, modulus 10^9 + 7$.</p>

<p>To answer this question, we need to know two facts:</p>

<ul>
  <li>We know that a set of characters can be a palindrome if there exists a bipartite graph where each vertex represents a character in the set and an edge exists between vertices if two characters are the same. Each vertex in this graph must have degree at least 1 (the exception is for a string with an odd number of characters. In this case, it must be true that there exists one character which you can remove from the set so that the aforementioned graph can be constructed from the rest of the characters in the set).</li>
</ul>

<p><strong>TLDR:</strong> A palindrome anagram of a string exists if: (1) for strings of even length, every unique character in the string can only occur an even number of times (2) for strings of odd length, there must only be one unique character that occurs in the string an odd number of times</p>

<ul>
  <li>We also note that we only need to know the first half of a palindromic string to know the entire string.</li>
</ul>

<p>With these two facts in mind, the answer to the challenge will <em>almost</em> be as simple as finding the number of unique permutations of all characters in one of the bipartitions of the aforementioned graph. However, since the question wants the answer to be returned $\bmod 10^9 + 7$ (perfectly reasonable as the actual number can grow insanely large), we will need to use modular arithmetic.</p>

<h2 id="calculating-the-number-of-unique-permutations-of-a-string-without-modular-arithmetic">Calculating the number of unique permutations of a string (without modular arithmetic)</h2>

<p>There are two formulas you can use to do this (note $n$ represents string length and $n_i$ represents number of occurences for one unique character):</p>

<script type="math/tex; mode=display">x = \frac{n!}{n_1!n_2!n_3!...n_n!}\tag{w/ factorials}</script>

<script type="math/tex; mode=display">x = {n \choose n_1}{n - n_1 \choose n_2}{n - n_1 - n_2 \choose n_3}...\tag{w/ binomial coefficients}</script>

<p>Explanation for the factorial formula can be found <a href="http://cs.stackexchange.com/a/2445">here</a>. I can try to explain the latter formula briefly. For the first unique character in the string, there are ${n \choose n_1}$ to place $n_1$ characters in $n$ spaces. For the next unique character in the string, since $n_1$ places are already taken up, there are ${n - n_1 \choose n_2}$ ways to distribute the next $n_2$ characters, and so on.</p>

<p>For my algorithm, I chose to go with the factorial equation.</p>

<h2 id="now-apply-modular-arithmetic">Now apply modular arithmetic</h2>

<p>There are two primary properties of modular arithmetic that is commonly used in programming. They are:</p>

<p><script type="math/tex">(a + b) \% m = ((a \% m) + (b \% m)) \% m\tag{addition}</script>
<script type="math/tex">(a * b) \% m = ((a \% m) * (b \% m)) \% m\tag{multiplication}</script></p>

<p>We will only need the multiplication property. Using this, we can define a modular multiplication method:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="java"><span class="line"><span class="kd">static</span> <span class="kt">long</span> <span class="n">M</span> <span class="o">=</span> <span class="o">((</span><span class="kt">long</span><span class="o">)</span><span class="n">Math</span><span class="o">.</span><span class="na">pow</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span> <span class="mi">9</span><span class="o">))</span> <span class="o">+</span> <span class="mi">7</span><span class="o">;</span>
</span><span class="line">
</span><span class="line"><span class="kd">static</span> <span class="kt">long</span> <span class="nf">modularMultiplication</span><span class="o">(</span><span class="kt">long</span> <span class="n">a</span><span class="o">,</span> <span class="kt">long</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
</span><span class="line">    <span class="k">return</span> <span class="o">((</span><span class="n">a</span> <span class="o">%</span> <span class="n">M</span><span class="o">)</span> <span class="o">*</span> <span class="o">(</span><span class="n">b</span> <span class="o">%</span> <span class="n">M</span><span class="o">))</span> <span class="o">%</span> <span class="n">M</span><span class="o">;</span>
</span><span class="line"><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>We can also define a factorial method using modular arithmetic. For the purposes of the question, $x$ will always be less than $M$ and <code>factorial</code> will always return values less than $M$. As such, we don’t need to use modular multiplication here:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="java"><span class="line"><span class="kd">static</span> <span class="kt">long</span> <span class="nf">factorial</span><span class="o">(</span><span class="kt">long</span> <span class="n">x</span><span class="o">){</span>
</span><span class="line">    <span class="k">if</span><span class="o">(</span><span class="n">x</span><span class="o">==</span><span class="mi">0</span><span class="o">||</span><span class="n">x</span><span class="o">==</span><span class="mi">1</span><span class="o">)</span>
</span><span class="line">        <span class="k">return</span> <span class="mi">1</span><span class="o">;</span>
</span><span class="line">    <span class="k">else</span> <span class="nf">return</span> <span class="o">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">factorial</span><span class="o">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="o">))</span> <span class="o">%</span> <span class="n">M</span><span class="o">;</span>
</span><span class="line"><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>You might’ve noticed that I left out something crucial that’s needed to solve this question: how do you perform modular division? * gasp * This is where Fermat’s little theorem comes into play (yay more math!). The theorem states that:</p>

<script type="math/tex; mode=display">a^{p - 1} \equiv 1 \bmod p, a \in \mathbb{R}\tag{where p is a prime number}</script>

<p>Did you also notice that $10^9 + 7$ is a prime number? This is the reason why we can apply the theorem to this question.</p>

<p>Starting from the theorem, we multiply both sides by $a^{-1}$ to get us:</p>

<script type="math/tex; mode=display">\begin{aligned}
a^{p - 2} \equiv a^{-1} \bmod p \\
a^{-1} \equiv a^{p - 2} \bmod p \\
\frac{1}{a} \equiv a^{p - 2} \bmod p
\end{aligned}</script>

<p>This means that all we need to do perform modular division is to find $a^{p - 2} \bmod p$. Then we can modular multiply the result with the dividend. The last final piece to the puzzle is how do we actually find that value quickly and efficiently? Well, fortunately, there is a modular exponentiation technique called binary exponentiation (or exponentiation by squaring) that can do this in logarithmic time (finds $a^n \bmod p$ in $\mathcal{O}(\log n)$).</p>

<p>Here’s the implementation of the algorithm in Java:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="java"><span class="line"><span class="kd">static</span> <span class="kt">long</span> <span class="nf">modularPow</span><span class="o">(</span><span class="kt">long</span> <span class="n">base</span><span class="o">,</span> <span class="kt">long</span> <span class="n">exponent</span><span class="o">,</span> <span class="kt">long</span> <span class="n">modulus</span><span class="o">)</span> <span class="o">{</span>
</span><span class="line">    <span class="kt">long</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
</span><span class="line">    <span class="n">base</span> <span class="o">=</span> <span class="n">base</span> <span class="o">%</span> <span class="n">modulus</span><span class="o">;</span>
</span><span class="line">    <span class="k">while</span> <span class="o">(</span><span class="n">exponent</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
</span><span class="line">        <span class="k">if</span> <span class="o">(</span><span class="n">exponent</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
</span><span class="line">            <span class="n">result</span> <span class="o">=</span> <span class="o">(</span><span class="n">result</span> <span class="o">*</span> <span class="n">base</span><span class="o">)</span> <span class="o">%</span> <span class="n">modulus</span><span class="o">;</span>
</span><span class="line">        <span class="o">}</span>
</span><span class="line">        <span class="n">exponent</span> <span class="o">=</span> <span class="n">exponent</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="o">;</span>
</span><span class="line">        <span class="n">base</span> <span class="o">=</span> <span class="o">(</span><span class="n">base</span> <span class="o">*</span> <span class="n">base</span><span class="o">)</span> <span class="o">%</span> <span class="n">modulus</span><span class="o">;</span>
</span><span class="line">    <span class="o">}</span>
</span><span class="line">    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
</span><span class="line"><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Finally, here’s the implementation of modular division:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="java"><span class="line"><span class="kd">static</span> <span class="kt">long</span> <span class="nf">modularDivision</span><span class="o">(</span><span class="kt">long</span> <span class="n">a</span><span class="o">,</span> <span class="kt">long</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
</span><span class="line">    <span class="k">return</span> <span class="nf">modularMultiplication</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">modularPow</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="n">M</span> <span class="o">-</span> <span class="mi">2</span><span class="o">,</span> <span class="n">M</span><span class="o">));</span>
</span><span class="line"><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Knowing all these, we can quickly find the result of $\frac{n!}{n_1!n_2!n_3!…n_n!} \bmod (10^9 + 7)$ and solve the problem.</p>

<blockquote>
  <p>Mathematical puns are the first sine of madness</p>
</blockquote>

    </div>
  </div>



  <footer>
    <hr>
    
    <div class="row-fluid">
      
      <div class="span6">
        <p class="meta">
        
        


        </p>
      </div>
      
      <div class="span6 social-sharing">
        <div class="sharing">
  <div class="addthis_toolbox addthis_default_style ">
  
  
  <a class="addthis_button_tweet"></a>
  
  
  <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>

      </div>
      
      
    </div>
    
    <div class="row-fluid">
      <div class="span12">
        <p class="meta">
          
            <a class="basic-alignment left" href="/blog/2014/11/25/hackerrank-challenge-sherlock-and-minimax/" title="Previous Post: Hackerrank challenge: Sherlock and MiniMax">&laquo; Hackerrank challenge: Sherlock and MiniMax</a>
          
          
            <a class="basic-alignment right" href="/blog/2014/11/29/some-notes-on-the-mercator-projection/" title="Next Post: Some notes on the Mercator projection">Some notes on the Mercator projection &raquo;</a>
          
        </p>
      </div>
    </div>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>



        </div>
      </div>
      <div class="row-fluid">
        <footer class="footer-page" role="contentinfo">
          <p>
  Copyright &copy; 2016 - Kevin Pan -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span> - Theme by <a href="http://alexgaribay.com">Alex Garibay</a>
</p>


        </footer>
      </div>
  </div>
  

<script type="text/javascript">
      var disqus_shortname = 'mangoicecream';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://kevinpan.me/blog/2014/11/28/today-i-used-fermats-little-theorem-outside-of-class-hackerrank-challenge-game-of-thrones-ii/';
        var disqus_url = 'http://kevinpan.me/blog/2014/11/28/today-i-used-fermats-little-theorem-outside-of-class-hackerrank-challenge-game-of-thrones-ii/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
